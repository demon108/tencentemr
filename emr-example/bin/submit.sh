/usr/local/service/spark/bin/spark-submit \
--master yarn \
--deploy-mode cluster \
--class  com.tencent.cloud.emr.CosLogParser \
--conf spark.locality.wait=2 \
--executor-memory 6g \
--num-executors  20  \
--executor-cores 1 \
--conf spark.memory.fraction=0.7 \
--conf spark.storage.storageFraction=0.1 \
--driver-memory 4g  \
--conf spark.shuffle.io.maxRetries=200 \
--conf spark.shuffle.file.buffer=64k \
--conf spark.shuffle.io.retryWait=15s \
--conf spark.kryoserializer.buffer.max=512m \
--conf spark.sql.crossJoin.enabled=true \
--conf spark.default.parallelism=20 \
--conf spark.sql.shuffle.partitions=20 \
--conf spark.io.compression.codec=snappy \
--conf spark.serializer=org.apache.spark.serializer.KryoSerializer \
--conf spark.sql.inMemoryColumnarStorage.compressed=true \
--conf spark.sql.inMemoryColumnarStorage.batchSize=10000 \
--conf "spark.executor.extraJavaOptions=-Xmn2g -XX:+UseG1GC -XX:MaxGCPauseMillis=50 -XX:GCPauseIntervalMillis=100" \
--conf "spark.driver.extraJavaOptions=-XX:+UseG1GC -XX:MaxGCPauseMillis=50 -XX:GCPauseIntervalMillis=100"  \
/usr/local/service/hadoop/emr-example-1.0-SNAPSHOT.jar /user/root/*/*.log /cos/output